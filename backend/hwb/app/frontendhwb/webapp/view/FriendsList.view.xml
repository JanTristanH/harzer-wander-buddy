<mvc:View
    controllerName="hwb.frontendhwb.controller.FriendsList"
    xmlns:mvc="sap.ui.core.mvc"
    xmlns="sap.m"
    xmlns:core="sap.ui.core"
    displayBlock="true"
    height="100%"
    busyIndicatorDelay="0"
>
    <Page title="{i18n>friends}" class="sapUiResponsiveContentPadding">
        <headerContent>
            <core:Fragment
                fragmentName="hwb.frontendhwb.fragment.currentUserAvatar"
                type="XML"
            />
        </headerContent>
        <content>
            <IconTabBar expandable="false">
                <items>
                    <IconTabFilter
                        key="friends"
                        text="{i18n>friends}"
                    >
                        <SearchField
                            id="idUserSearchField"
                            showSearchButton="false"
                            enableSuggestions="false"
                            liveChange=".onSearchFieldLiveChange"
                            suggestionItems="{local>/suggestionItems}"
                        >
                            <SuggestionItem />
                        </SearchField>
                        <!-- friends of User -->
                        <List
                            id="idFriendsList"
                            items="{
                                path: '/MyFriends'
                            }"
                            headerText="{i18n>friendListHeader}"
                            noDataText="{i18n>friendListNoData}"
                            selectionChange="onFriendSelectionChange"
                            mode="SingleSelectMaster"
                        >
                            <items>
                                <CustomListItem>
                                    <HBox
                                        justifyContent="SpaceBetween"
                                        alignItems="Center"
                                        width="100%"
                                        class="sapUiTinyMargin"
                                    >
                                        <HBox alignItems="Center">
                                            <Avatar
                                                src="{picture}"
                                                displaySize="S"
                                                class="sapUiSmallMarginEnd"
                                                initials="{parts: ['name'], formatter: '.onFormatInitialsByName'}"
                                            />
                                            <VBox 
                                                class="sapUiTinyMargin"
                                            >
                                                <Text
                                                    text="{name}"
                                                />
                                                <Label text="{i18n>isAllowedToStampForMe}"      visible="{= ${isAllowedToStampForMe} &amp;&amp; !${isAllowedToStampForFriend} }" />
                                                <Label text="{i18n>isAllowedToStampForFriend}"  visible="{= !${isAllowedToStampForMe} &amp;&amp; ${isAllowedToStampForFriend} }" />
                                                <Label text="{i18n>isAllowedToStampBothWays}"   visible="{= ${isAllowedToStampForMe} &amp;&amp; ${isAllowedToStampForFriend} }" />
                                            </VBox>
                                        </HBox>
                                        <HBox>
                                            <Button
                                                icon="sap-icon://navigation-right-arrow"
                                                type="Transparent"
                                                press="onNavToFriendPress"
                                                class="sapUiSmallMarginEnd"
                                            />
                                            <Button
                                                icon="sap-icon://add"
                                                type="Transparent"
                                                visible="{= !${isFriend} }"
                                                press="onAddFriend"
                                                class="sapUiSmallMarginEnd"
                                            />
                                            <Button
                                                icon="sap-icon://delete"
                                                type="Transparent"
                                                visible="{isFriend}"
                                                press="onRemoveFriend"
                                                class="sapUiSmallMarginEnd"
                                            />
                                        </HBox>
                                    </HBox>
                                </CustomListItem>
                            </items>
                        </List>
                    </IconTabFilter>
                    <IconTabFilter
                        id="pendingFriendshipRequestsIconTabFilter"
                        key="pendingFriendshipRequests"
                        text="{i18n>pendingFriendshipRequests} (0)"
                    >
                        <!-- PendingFriendshipRequests of user-->
                        <List
                            id="idPendingFriendshipRequestsList"
                            items="{path: '/PendingFriendshipRequests', parameters: {expand: 'fromUser,toUser'}}"
                            noDataText="{i18n>pendingFriendshipRequestsNoData}"
                            updateFinished="onUpdateFinished"
                        >
                            <items>
                                <StandardListItem
                                    title="{i18n>requestFrom}: {toUser/name}"
                                    description="{i18n>clickToAccept}"
                                    icon="{toUser/picture}"
                                    type="Active"
                                    press="onAcceptPendingFriendshipRequest"
                                />
                            </items>
                        </List>
                    </IconTabFilter>
                </items>
            </IconTabBar>
        </content>
        <footer>
            <core:Fragment
                fragmentName="hwb.frontendhwb.fragment.Toolbar"
                type="XML"
            />
        </footer>
    </Page>
</mvc:View>
