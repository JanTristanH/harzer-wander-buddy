<mvc:View
    controllerName="hwb.frontendhwb.controller.RoutesMap"
    xmlns:mvc="sap.ui.core.mvc"
    xmlns:core="sap.ui.core"
    xmlns="sap.m"
    xmlns:l="sap.ui.layout"
    xmlns:dnd="sap.ui.core.dnd"
    displayBlock="true"
    height="100%"
    busyIndicatorDelay="0"
>
    <HBox justifyContent="SpaceBetween">
        <Button
            class="sapUiTinyMargin"
            press='onBackToList'
            type="Transparent"
            text="{i18n>back}"
            icon="sap-icon://navigation-left-arrow"
        />
        <HBox>
            <Button
                class="sapUiTinyMargin"
                text="{i18n>share}"
                icon="sap-icon://share-2"
                type="Transparent"
                press="onButtonShareTourPress"
            />
            <Button
                class="sapUiTinyMargin"
                text="{i18n>edit}"
                icon="sap-icon://edit"
                visible="{= !${local>/edit} }"
                press="onButtonEditPress"
            />
            <Button
                class="sapUiTinyMargin"
                text="{i18n>delete}"
                icon="sap-icon://delete"
                visible="{local>/edit}"
                type="Transparent"
                press="onButtonDeletePress"
            />
            <Button
                class="sapUiTinyMargin"
                text="{i18n>save}"
                icon="sap-icon://save"
                visible="{local>/edit}"
                press="onButtonSavePress"
            />
        </HBox>
    </HBox>
    <Panel
        expandable="true"
        expanded="true"
        width="auto"
        visible="{local>/edit}"
        headerText="{i18n>wayPoints}"
        class="sapUiTinyMargin"
    >
        <Input
            value="{local>/oSelectedTour/name}"
            change="onNameInputChange"
        />
        <Table
            id="idEditRouteTable"
            noDataText="{i18n>noWayPointsPleaseAdd}"
            mode="SingleSelectMaster"
            items="{
            path: 'local>/oSelectedTour/path',
            sorter: {
                path: 'rank',
                descending: true
            }
        }"
        >
            <headerToolbar>
                <OverflowToolbar>
                    <ToolbarSpacer />
                    <Button
                        icon="sap-icon://add"
                        type="Transparent"
                        press="onAddWayPointButtonPress"
                    />
                </OverflowToolbar>
            </headerToolbar>
            <columns>
                <Column visible="false" />
                <Column visible="false" />
                <Column visible="false" />
                <Column width="70%" />
                <Column />
                <Column />
                <Column />
            </columns>
            <dragDropConfig>
                <dnd:DragInfo
                    groupName="selected2available"
                    sourceAggregation="items"
                />
                <dnd:DropInfo
                    groupName="available2selected"
                    targetAggregation="items"
                    dropPosition="Between"
                    drop="onDropSelectedProductsTable"
                />
                <dnd:DragDropInfo
                    sourceAggregation="items"
                    targetAggregation="items"
                    dropPosition="Between"
                    drop="onDropSelectedProductsTable"
                />
            </dragDropConfig>
            <items>
                <ColumnListItem>
                    <cells>
                        <Text
                            text="{local>rank}"
                            visible="true"
                        />
                        <!-- used for easy access in controller -->
                        <Text
                            text="{local>ID}"
                            visible="false"
                        />
                        <!-- used for easy access in controller -->
                        <Text
                            text="{local>toPoi}"
                            visible="false"
                        />
                        <Input
                            class="sapUiSmallMarginTop sapUiSmallMarginBottom"
                            placeholder="{i18n>enterStampOrParking}"
                            showSuggestion="true"
                            suggestionItemSelected="onSuggestionItemSelected"
                            suggestionItems="{/AllPointsOfInterest}"
                            value="{local>name}"
                        >
                        <suggestionItems>
                            <core:Item text="{name}">
                                <core:customData>
                                    <core:CustomData key="ID" value="{ID}" />
                                </core:customData>
                            </core:Item>
                        </suggestionItems>
                        </Input>
                        <Button icon="sap-icon://up" type="Transparent" press="onUpButtonPress"/>
                        <Button icon="sap-icon://down" type="Transparent" press="onDownButtonPress"/>
                        <Button
                            icon="sap-icon://delete"
                            type="Transparent"
                            press="onDeleteWayPointButtonPress"
                        />
                    </cells>
                </ColumnListItem>
            </items>
        </Table>
    </Panel>
    <l:Splitter
        orientation="Vertical"
        id="idRoutesDetialSplitter"
        resize="onSplitterRoutesDetailResize"
    >
        <mvc:XMLView
            id="RoutesMapId"
            async="true"
            viewName="hwb.frontendhwb.view.MapInner"
        />
        <VBox>
            <layoutData>
                <l:SplitterLayoutData
                    id="idTourKeyFactsSplitterLayoutData"
                    size="20%"
                />
            </layoutData>
            <FlexBox
                justifyContent="SpaceAround"
                alignItems="Center"
                class="sapUiSmallMarginTop sapUiSmallMarginBottom"
            >
                <VBox
                    alignContent="Center"
                    alignItems="Center"
                    class="sapUiMediumMarginBegin"
                >
                    <core:Icon src="sap-icon://fob-watch" />
                    <Text
                        text="{path: 'local>/oSelectedTour/duration', formatter: '.formatSecondsToTime'}"
                    />
                </VBox>
                <Text text="|" />
                <VBox
                    alignContent="Center"
                    alignItems="Center"
                >
                    <core:Icon src="sap-icon://direction-arrows" />
                    <Text
                        text="{path: 'local>/oSelectedTour/distance', formatter: '.formatMetersToKilometers'}"
                    />
                </VBox>
                <Text text="|" />
                <VBox
                    alignContent="Center"
                    alignItems="Center"
                >
                    <core:Icon src="sap-icon://toaster-top" />
                    <Text text="{local>/oSelectedTour/stampCount}" />
                </VBox>
                <Text text="|" />
                <VBox
                    alignContent="Center"
                    alignItems="Center"
                    class="sapUiMediumMarginEnd"
                >
                    <core:Icon src="sap-icon://trend-up" />
                    <Text text="-" />
                </VBox>
            </FlexBox>
            <Panel
                expandable="false"
                expanded="true"
                width="auto"
                headerText="{i18n>wayPoints}"
                class="sapUiTinyMargin"
            >
                <ScrollContainer
                    width="100%"
                    height="{local>/wayPointScrollContainerHeight}"
                    vertical="true"
                    horizontal="false"
                >
                    <List
                        id="idRoutesWayPointList"
                        growingScrollToLoad="true"
                        items="{local>/oSelectedTour/path}"
                    >
                        <StandardListItem
                            wrapping="true"
                            title="{local>name}"
                            description="{parts: [{path: 'local>duration'}, {path: 'local>distance'}], formatter: '.formatDescription'}"
                            icon="{path: 'local>travelMode', formatter: '.onFormatTravelModeIcon'}"
                        />
                    </List>
                </ScrollContainer>
            </Panel>
        </VBox>
    </l:Splitter>
</mvc:View>
